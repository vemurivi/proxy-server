import { Injectable } from '@angular/core';

// Import the SOR models with employees
import { WorkAreaJob as SORWorkAreaJob, Employee } from 'src/app/models/interfaces/sor'; 
import { WorkAreaType as SORWorkAreaType } from 'src/app/models/interfaces/sor';
import { WorkArea as SORWorkArea } from 'src/app/models/interfaces/sor';

// Union Types to handle both DOP and SOR
type WorkAreaJob = DOPWorkAreaJob | SORWorkAreaJob;
type WorkArea = DOPWorkArea | SORWorkArea;
type WorkAreaType = DOPWorkAreaType | SORWorkAreaType;

@Injectable({
  providedIn: 'root'
})
export class SearchHelperService {

  constructor() { }

  public buildWATSearchString(wat: WorkAreaType): string {
    let _ss: string = wat.workAreaTypeName.toLowerCase();
    wat.workAreas.forEach(area => {
      _ss += ',' + area.workAreaName.toLowerCase();
      area.workAreaJobs.forEach(job => {
        _ss += ',' + job.workAreaJobName.toLowerCase();
        if ('employees' in job && job.employees) {  // Check if 'employees' exists
          job.employees.forEach(emp => {
            _ss += ',' + emp.employeeName.toLowerCase();  // Search by employee name
            _ss += ',' + emp.employeeId.toLowerCase();    // Search by employee ID
          });
        }
      });
    });
    return _ss;
  }

  public buildWASearchString(wa: WorkArea): string {
    let _ss: string = wa.workAreaName.toLowerCase();
    wa.workAreaJobs.forEach(job => {
      _ss += ',' + job.workAreaJobName.toLowerCase();
      if ('employees' in job && job.employees) {  // Check if 'employees' exists
        job.employees.forEach(emp => {
          _ss += ',' + emp.employeeName.toLowerCase();  // Search by employee name
          _ss += ',' + emp.employeeId.toLowerCase();    // Search by employee ID
        });
      }
    });
    return _ss;
  }

  public buildWAJSearchString(waj: WorkAreaJob): string {
    let _ss: string = waj.workAreaJobName.toLowerCase();
    if ('employees' in waj && waj.employees) {  // Check if 'employees' exists
      waj.employees.forEach(emp => {
        _ss += ',' + emp.employeeName.toLowerCase();  // Search by employee name
        _ss += ',' + emp.employeeId.toLowerCase();    // Search by employee ID
      });
    }
    return _ss;
  }
}
